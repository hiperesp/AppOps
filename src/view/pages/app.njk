{% extends 'layout.njk' %}

{% set tabs = {
    overview: "Overview",
    access_logs: "Access Logs",
    error_logs: "Error Logs",
    app_logs: "App Logs",
    settings: "Settings"
} %}
{% if tab not in tabs %}
    {% set tab = "overview" %}
{% endif %}

{% set title %}{{ app.name }} - {{ tabs[tab] }}{% endset %}

{% set breadcrumb = [
    {
        text: namespace.name,
        href: '/' + namespace.name
    },
    {
        text: app.name,
        active: true,
        ehref: '//' + (app.domains.app[0] or app.domains.global[0])
    }
] %}
{% set tabs %}
    <ul class="nav nav-tabs px-md-5 px-3">
        {% for key, value in tabs %}
            {% if tab === key %}
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="?tab={{ key }}">{{ value }}</a>
                </li>
            {% else %}
                <li class="nav-item">
                    <a class="nav-link" href="?tab={{ key }}">{{ value }}</a>
                </li>
            {% endif %}
        {% endfor %}
        <li class="nav-item">
            <a class="nav-link disabled">Disabled</a>
        </li>
    </ul>
{% endset %}

{% block content %}
    <main>
        <div class="container pt-3">
            <div class="mb-3 d-flex justify-content-end gap-1">
                <button type="button" class="btn btn-light btn-sm"><i class="bi bi-pencil-fill"></i> Edit</button>
                <button type="button" class="btn btn-dark btn-sm"><i class="bi bi-window-plus"></i> Scale</button>
            </div>
            <div class="mx-2">
                {% if tab == "overview" %}
                    Overview
                {% elseif tab == "access_logs" or tab == "error_logs" or tab == "app_logs" %}
                    <div class="row">
                        <pre class="bg-black text-white w-100 p-3 border-dark rounded" style="height: 400px;" data-logs="{{ tab }}">{{ tab }}</pre>
                    </div>
                {% elseif tab == "settings" %}

                    <div class="row">
                        <div class="col-md-3">
                        </div>

                        <div class="col-md-6">
                            <form>
                                <h4 class="mb-2">General</h4>
                                <p class="mb-4 text-muted">General settings for your app.</p>

                                <div class="form-group mb-3">
                                    <label for="name" class="fw-bold">App name</label>
                                    <input type="name" class="form-control" id="name" name="name" value="{{ app.name }}">
                                </div>

                                <div class="form-group mb-3">
                                    <label for="proxy-ports" class="fw-bold">Proxy Ports</label>
                                    <textarea class="form-control" id="proxy-ports" name="proxy-ports" rows="{{ app.proxyPorts.length + 1 }}">{% for proxyPorts in app.proxyPorts %}{{ proxyPorts + "\n" }}{% endfor %}</textarea>
                                </div>

                                <div class="form-group mb-3">
                                    <label for="domains" class="fw-bold">Domains</label>
                                    <textarea class="form-control" id="domains" name="domains" rows="{{ app.domains.app.length + 1 }}">{% for domain in app.domains.app %}{{ domain + "\n" }}{% endfor %}</textarea>
                                </div>

                                <div class="form-group mb-3">
                                    <label class="fw-bold">Domains (Global)</label>
                                    <textarea class="form-control" rows="{{ app.domains.global.length }}" disabled="" resize="none">{% for domain in app.domains.global %}{{ domain }}{{ "\n" if not loop.last }}{% endfor %}</textarea>
                                </div>

                                <button type="submit" class="btn btn-dark w-100">Sign in</button>

                            </form>
                        </div>
                    </div>

                    <hr>
                    App dump:
                    {{ app | dump }}
                {% endif %}
            </div>
        </div>
    </main>
{% endblock %}